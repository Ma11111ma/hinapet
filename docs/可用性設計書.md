# docs/availability_design.md（可用性設計）

## 1. 目標

- 稼働率 99.5%（MVP）→ 将来 99.9%
- RTO ≤ 60 分、RPO ≤ 15 分

## 2. 構成（概念）

- Web/API：コンテナ冗長化（≥2）、L4/L7 LB、ヘルスチェック
- DB：単一ノード（MVP）→ リードレプリカ/HA 構成へ拡張
- ストレージ：オブジェクトストレージ（静的アセット/CDN）
- 監視/アラート：Uptime + メトリクス + ログ

## 3. 冗長化・復旧

- ローリングデプロイ、失敗時自動ロールバック
- コンテナヘルスチェック再起動、サーキットブレーカ/リトライ
- バックアップからの復元手順（Runbook 参照）

## 4. グレースフル・デグレード

- 外部 API 障害時：検索結果キャッシュ、機能一時無効化（バナー表示）
- 地図不可時：リストビュー fallback
- 認証不可時：ゲスト閲覧モード（可能な範囲）

## 5. メンテナンス

- 計画停止は事前告知（48h 前）、深夜帯、ステータスページ更新

## 6. テスト

- 障害訓練：四半期に 1 回（DB 停止 → 復旧、API 片系落ち）
- バックアップリストア演習：半年に 1 回

---

### 作成時の注意点

- **単一障害点（SPOF）**を洗い出し、段階的に排除するロードマップを記載。
- **デグレード時の UX**（何を表示するか）を UI 仕様に落とし込む。
- **復旧手順の検証**を定期運用に組み込む。
