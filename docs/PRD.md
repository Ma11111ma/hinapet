### 1. プロジェクト概要（Overview）

- **プロダクト名**：ペット避難（Pet Evacuation Support App）
- **作成日**：2025 年 10 月 9 日

---

### 2. 背景（Background）

- **なぜこのプロダクト／機能が必要か？**
- **現在の課題やビジネス的背景**
  ### ① 国レベルでの社会課題（マクロ）
  日本は地震・台風・豪雨などの自然災害が多発する国です。
  その中で、**ペットの飼育世帯は全世帯の約 4 割**にのぼり、ペットは家族の一員として日常生活の中に深く根付いています。
  しかし災害時、**「人」と「ペット」双方の安全をどう確保するか**という観点は、依然として制度・情報・設備の面で十分に整備されていません。
  環境省は「**飼い主はペットと一緒に避難する（同行避難）**」を推奨していますが、
  この「同行避難」はあくまで**一緒に避難所へ向かうこと**を指し、**避難所内で同室に滞在できる**「同伴避難」とは異なります。
  そのため、飼い主は「実際にどこまで受け入れ可能なのか」を災害時に自力で調べる必要があり、全国的な情報整備の遅れが大きな課題となっています。
  ***
  ### ② 自治体・地域単位での運用課題（メゾ）
  ペット避難に関する運用・情報提供は**自治体ごとに形式や範囲が異なる**のが現状です。
  避難所の開設状況やペット受け入れ可否、混雑度などの情報は自治体の Web サイトや PDF、紙資料などに分散し、
  発災後にそれらを検索・照合することは非常に困難です。
  また自治体側も、
  - 情報のリアルタイム更新手段が限られている
  - 電話問い合わせ対応や現場確認に負荷が集中する
  - 居住者への周知が追いつかない
    といった運用上の課題を抱えています。
  この結果、**情報の非対称性（自治体と住民の間の情報格差）**が発生し、避難行動の遅れや混乱につながっています。
  ***
  ### ③ 災害現場・個人レベルでの行動課題（ミクロ）
  実際の災害時には、
  - 「ペットを受け入れてもらえる避難所がわからない」
  - 「一緒に避難しても分離させられる可能性がある」
    といった不安から、**飼い主が避難をためらう**ケースが多く報告されています。
  その結果、
  - ペットを家に残して様子を見に戻り、**二次災害に巻き込まれる**
  - 飼い主と離れたペットが**野犬化・繁殖し、地域や生態系に悪影響を及ぼす**
  - ペットを失ったことによる**飼い主の精神的ショック・ストレスの増大**
  といった深刻な事態が生じています。

---

### 3. 目的・ゴール（Goals / Objectives）

- こ**のプロダクトで達成したいこと**
  - 住民（ペット飼育者）が、現在地やキーワードから **ペット同行／同伴可能な避難所を即座に検索・ルート確認できる** ようにする。
  - 自治体が避難所の開設・混雑状況をリアルタイムに更新できる管理画面を提供し、**住民との情報共有を円滑化**する。
  - 将来的には、ペットの健康管理・持ち物リマインダー機能などを拡張し、**防災意識の向上・行動支援の継続利用**を狙う。
- KPI（あれば）
  **KPI 例**：
  - 避難所検索機能の利用回数（1 ユーザーあたり）
  - お気に入り登録数
  - 自治体担当者の避難所更新率

---

### 4. 対象ユーザー（Target Users）

- 想定ユーザー像（ペルソナ）
- ユーザーの課題やニーズ

| ユーザー種別             | 課題・ニーズ                                                                                       |
| ------------------------ | -------------------------------------------------------------------------------------------------- |
| ペット飼育者（一般住民） | 災害時に避難できる場所がわからない／ペットの受け入れ可否を即時に知りたい／ルート・混雑も確認したい |
| 自治体担当者             | 避難所の開設・混雑状況を住民へリアルタイムに発信したい／紙・電話連絡では限界がある                 |
| （アプリ管理者）         | サービス全体を統括し、避難所データや利用状況を一元管理したい                                       |

---

### 5. スコープ（Scope）

### ✅ 含まれる機能

- ログイン（Firebase 認証）
- 地図検索（同行／同伴の可視化、現在地／距離検索、ルート表示）
- 避難所データ管理（自治体向け管理画面）
- お気に入り登録・解除
- Stripe 決済（プレミアム登録）

### ❌ 含まれない機能（今回は対象外）

- 音声検索・音声案内機能（将来拡張）
- 分離避難施設の独自登録（Google 検索補完のみ）
- 家族登録と安否確認（将来拡張）

---

### 6. ユーザーストーリー（User Stories）

- 私は **ペットを飼っている人** として、現在地からペット同行避難所を検索したい。なぜなら、災害時に素早く安全な避難先を見つけたいから。
- 私は **自治体担当者** として、避難所の開設・混雑状況をリアルタイムで更新したい。なぜなら、正確な情報を住民に届けたいから。
- 私は **ユーザー** として、お気に入り登録した避難所をすぐに表示したい。なぜなら、毎回検索する手間を省きたいから。
- 私は **プレミアムユーザー** として、健康チェックや持ち物リスト機能を使いたい。なぜなら、避難準備を日常的に行いたいから。

---

### 7. 画面設計（Wireframes / UI 設計）

- 画面遷移図や簡単なモック
  [Figma ワイヤーフレーム](https://www.figma.com/design/7RUPf0lI1ZaFbjRZvDv2MI/%E3%83%9A%E3%83%83%E3%83%88%E7%81%BD%E5%AE%B3%E6%99%82%E9%81%BF%E9%9B%A3?node-id=0-1&t=Dk1YB1D6PvwHV9RE-1)

| 画面               | 概要                                                                         |
| ------------------ | ---------------------------------------------------------------------------- |
| 地図検索画面       | トップページ。地図上に避難所ピン（同行・同伴）を表示、検索・ルート表示が可能 |
| ログイン／登録画面 | Firebase によるログイン・認証                                                |
| マイページ         | 飼い主・ペット情報の登録、プレミアム登録への導線                             |
| 管理者画面         | 自治体用。避難所の開設・混雑・緊急通報設定を行う                             |
| Stripe 決済画面    | プレミアム登録用。決済情報入力 → 完了                                        |

- UX のフローなど

---

### 8. 非機能要件（Non-functional Requirements）

- パフォーマンス
- セキュリティ
- 対応ブラウザ／OS など

| 項目           | 内容                                         |
| -------------- | -------------------------------------------- |
| パフォーマンス | レスポンス 1 秒以内（95%以上）               |
| セキュリティ   | TLS 対応、OWASP Top10 対策                   |
| 対応ブラウザ   | Chrome, Safari（最新 2 バージョン）          |
| 可用性         | 99.9% 稼働を目標                             |
| 拡張性         | API 構成をマイクロサービス化できる設計にする |

---

### 9. 技術要件（Tech Requirements）

- 使用技術
- 外部サービスとの連携

| 項目           | 内容                                    |
| -------------- | --------------------------------------- |
| フロントエンド | Next.js（Vercel デプロイ）              |
| バックエンド   | FastAPI（Render／Railway）、Docker 対応 |
| DB             | Supabase（PostgreSQL）                  |
| 認証           | Firebase Authentication                 |
| 決済           | Stripe                                  |
| 外部 API       | Google Maps API（地図・ルート・距離）   |

---

### 10. マイルストーン／スケジュール（Timeline）

---

### 11. リスクと懸念点（Risks & Concerns）

| リスク                              | 対応策                                             |
| ----------------------------------- | -------------------------------------------------- |
| 自治体 PDF の形式が統一されていない | Python で柔軟なパーサーを作成、手動補正も許容      |
| Google Maps API コスト              | キャッシュ＋距離計算の最適化でリクエスト削減       |
| データ更新の運用面                  | 管理画面の UI を簡素化、自治体運用マニュアルを用意 |
| 決済機能の不具合                    | テストモードで徹底検証、Webhook で状態同期         |
| 音声検索等の拡張機能                | MVP ではスコープ外とし、仕様は別ドキュメント化     |
